<% @page_title = "New trip" %>

<div class="bg-[#F2FFFB] rounded-t-2xl p-5 flex-grow">

  <div class="bg-white rounded-2xl shadow-md p-6 space-y-5">

    <p class="text-sm text-[#06231B]/60">
      Create a new trip. The budget currency is based on your settings.
    </p>

    <%= form_with(model: @trip, local: true) do |f| %>

      <%# COUNTRY (searchable later if you want) %>
      <div data-controller="searchable-select" class="relative w-full">

        <%# Hidden field that will be sumbitted to Rails %>
        <%= f.label :country, "Country", class: "block text-sm font-medium text-[#06231B] mt-4" %>
        <%= f.hidden_field :country,
            data: { "searchable-select-target": "hiddenField" } %>

        <%# Search box that the user types into %>
        <input
          type="text"
          placeholder="Search a country..."
          class="w-full mt-1 px-4 py-3 bg-[#F7FAF9] border border-[#E6ECEA] rounded-xl
                focus:ring-[#21A179] focus:border-[#21A179] text-[#06231B]"
          data-searchable-select-target="search"
          data-action="input->searchable-select#filter click->searchable-select#toggleList"
          >

        <%# Dropdown list of country options %>
        <div
          class="absolute z-50 mb-2 w-full bg-white rounded-xl shadow-lg border border-gray-200 max-h-60 overflow-y-auto hidden"
          data-searchable-select-target="list">

          <% ISO3166::Country.all.each do |country| %>
            <div
              class="px-4 py-2 text-[#06231B] hover:bg-[#F2FFFB] cursor-pointer"
              data-action="click->searchable-select#select"
              data-value="<%= country %>">

              <%= country %>
            </div>
          <% end %>
        </div>
      </div>

      <%# BUDGET AMOUNT %>
      <div>
        <%= f.label :budget, "Budget", class: "block text-sm font-medium text-[#06231B] mt-4" %>
        <%= f.number_field :budget,
              step: "0.01",
              class: "w-full mt-1 px-4 py-3 bg-[#F7FAF9] border border-[#E6ECEA] rounded-xl
                     focus:ring-[#21A179] focus:border-[#21A179] text-[#06231B] shadow-sm" %>
      </div>

      <%# BUDGET CURRENCY (visible but uneditable) %>
      <div>
        <%= label_tag :budget_currency, "Budget Currency",
              class: "block text-sm font-medium text-[#06231B] mt-4" %>

        <div class="w-full mt-1 px-4 py-3 bg-[#F7FAF9] border border-[#E6ECEA] rounded-xl text-[#06231B] shadow-sm opacity-70">
          <%= current_user.base_currency %>
        </div>

        <p class="text-xs text-[#06231B]/50 mt-1">
          Change this in Settings.
        </p>
      </div>

      <%# START DATE %>
      <div>
        <%= f.label :start_date, "Start Date", class: "block text-sm font-medium text-[#06231B] mt-4" %>
        <%= f.date_field :start_date,
              class: "w-full mt-1 px-4 py-3 bg-[#F7FAF9] border border-[#E6ECEA] rounded-xl
                     focus:ring-[#21A179] focus:border-[#21A179] text-[#06231B] shadow-sm" %>
      </div>

      <%# END DATE %>
      <div>
        <%= f.label :end_date, "End Date", class: "block text-sm font-medium text-[#06231B] mt-4" %>
        <%= f.date_field :end_date,
              class: "w-full mt-1 px-4 py-3 bg-[#F7FAF9] border border-[#E6ECEA] rounded-xl
                     focus:ring-[#21A179] focus:border-[#21A179] text-[#06231B] shadow-sm" %>
      </div>

      <%# SUBMIT BUTTON %>
      <div class="pt-4">
        <%= f.submit "Create Trip",
              class: "w-full bg-[#21A179] text-white py-3 rounded-full font-semibold text-base
                     hover:bg-[#1b8a67] transition" %>
      </div>

    <% end %>

  </div>
</div>
